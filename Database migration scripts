BEGIN;
1. Departments Table
CREATE TABLE IF NOT EXISTS departments (
  dept_id        SERIAL PRIMARY KEY,
  dept_code      TEXT UNIQUE,
  name           TEXT NOT NULL,
  manager_emp_id INTEGER NULL
);

2.Employees Table
CREATE TABLE IF NOT EXISTS employees (
  emp_id        SERIAL PRIMARY KEY,
  external_id   TEXT UNIQUE,
  full_name     TEXT NOT NULL,
  email         TEXT UNIQUE,
  dept_id       INTEGER,
  role          TEXT,
  employment_type TEXT,
  annual_salary NUMERIC,
  join_date     DATE,
  city          TEXT,
  skills        TEXT,
  reports_to    INTEGER NULL,
  CONSTRAINT fk_dept FOREIGN KEY (dept_id) REFERENCES departments (dept_id) ON DELETE SET NULL,
  CONSTRAINT fk_manager FOREIGN KEY (reports_to) REFERENCES employees (emp_id) ON DELETE SET NULL
);

3.Performance Reviews Table
CREATE TABLE IF NOT EXISTS performance_reviews (
  review_id    SERIAL PRIMARY KEY,
  emp_id       INTEGER NOT NULL,
  review_date  DATE NOT NULL,
  rating       INTEGER,
  comments     TEXT,
  CONSTRAINT fk_review_emp FOREIGN KEY (emp_id) REFERENCES employees (emp_id) ON DELETE CASCADE
);

4.Performance Reviews Table
CREATE TABLE IF NOT EXISTS performance_reviews (
  review_id    SERIAL PRIMARY KEY,
  emp_id       INTEGER NOT NULL,
  review_date  DATE NOT NULL,
  rating       INTEGER,
  comments     TEXT,
  CONSTRAINT fk_review_emp FOREIGN KEY (emp_id) REFERENCES employees (emp_id) ON DELETE CASCADE
);

5.Documents Table
CREATE TABLE IF NOT EXISTS documents (
  doc_id       SERIAL PRIMARY KEY,
  emp_id       INTEGER NULL,
  filename     TEXT NOT NULL,
  file_type    TEXT,
  content_text TEXT,
  uploaded_at  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  source       TEXT,
  CONSTRAINT fk_doc_emp FOREIGN KEY (emp_id) REFERENCES employees (emp_id) ON DELETE SET NULL
);

6.Document Chunks Table
CREATE TABLE IF NOT EXISTS document_chunks (
  chunk_id     SERIAL PRIMARY KEY,
  doc_id       INTEGER NOT NULL,
  chunk_index  INTEGER NOT NULL,
  chunk_text   TEXT NOT NULL,
  chunk_meta   JSONB NULL,
  created_at   TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT fk_chunk_doc FOREIGN KEY (doc_id) REFERENCES documents (doc_id) ON DELETE CASCADE
);

7.Indexes
CREATE INDEX IF NOT EXISTS idx_employees_dept ON employees(dept_id);
CREATE INDEX IF NOT EXISTS idx_employees_name ON employees(full_name);
CREATE INDEX IF NOT EXISTS idx_employees_skills ON employees(skills);
CREATE INDEX IF NOT EXISTS idx_documents_emp ON documents(emp_id);

7.


